---
title: "Group Project - Draft Proposal"
author: "Tseegi Nyamdorj, Tina Chang, Jinwen Xiang, My My Tran"
date: '2023-03-13'
output: 
  pdf_document:
    toc: yes
    toc_depth: '2'
  html_document:
    toc: yes
    toc_depth: 2
    toc_float: yes
    fig_width: 7
    fig_height: 6
    fig_caption: yes
    theme: lumen
    df_print: paged
    code_folding: show
---
# Title: The Influence of Parenthood and Age on Adults Pursuing Higher Education

# Purpose and Hypotheses
The aim of this project is to investigate the impact of parenthood on the likelihood of adults obtaining higher education, with a specific focus on parents with children and the number of children they have. Previous research suggests that having children may affect a parent's pursuit of higher education. For instance, Kulp (2016) found that "mothers with doctorates tended to take longer to complete the degree and graduated at an older age than their non-parent counterparts. They tended to finance their degrees through loans and personal savings rather than scholarships" (Kulp, p.255)." Given these findings, we are interested in exploring this relationship.

The \textbf{primary hypothesis} is that adults with no children or fewer children are more likely to pursue higher education in their adult years than adults with 3 or more children.

The \textbf{secondary hypothesis}: 

1. Younger adults are more likely to have attended higher education within the last six years than older adults.

# Data

This study will use data from the National Surveys of College Graduates (NSCG), Recent College Graduates (NSRCG), and Doctorate Recipients (SDR) available in the IPUMS database. The NSCG is a survey of individuals residing in the United States who hold a bachelor's degree or higher, while the SDR collects data from individuals who received a doctorate degree from a US institution. The NSRCG collects data from individuals who obtained a science or engineering degree from a US institution within the last two years. All three surveys collect data from individuals under the age of 76. To increase our sample size, we will be using data from the year 2010. The data is available at this URL: https://highered.ipums.org/highered-action/variables/group?id=demog.

# Outcome Variable

The outcome variable determines whether or not the adult is pursuing or has pursued higher education in the last 6 years. It is binary; 0 indicates false and 1 indicates true.

We will use logistic regression to model this outcome.

# Explanatory Variables

For the primary explanatory variable, we will use the variable CHTOT; the number of children, which is categorical with three levels: 1 - one child, 3 - two or more children, 98 - no child

For the secondary explanatory variables,

-AGE; the age of the parent, which is numerical from 23 to 75.

-ACFPT; current enrollment student status (1 - part-time student, 2- full-time student, 3- not enrolled in a degree program but taking courses, 98 - logical skip)

The explanatory variables shown in our regression models:

## Primary Hypothesis

The primary hypothesis is that adults with no children or fewer children are more likely to pursue higher education in their adult years than adults with 3 or more children.

The test of our hypothesis will be:

$H_0: \beta_1 = \beta_2 = \beta_3 = \beta_4 = 0$

$H_A: \beta_1 \neq \beta_2 \neq \beta_3 \neq \beta_4 \neq0$

$logit(degree within last 6 years)=\beta_0+\beta_1CHTOT+\beta_2 * 1(nochild)+\beta_3 * 1(one child)+\beta_4 * 1(2+ children)$

## Secondary Hypothesis
Younger adults are more likely to have attended higher education within the last six years than older adults.

The test of our hypothesis will be:

$H_0: \beta_1 = \beta_2 = \beta_3 = \beta_4 = 0$

$H_A: \beta_1 \neq \beta_2 \neq \beta_3 \neq \beta_4 \neq0$

$logit(degree within last 6 years)=\beta_0+\beta_1CHTOT+\beta_2 * 1(no child) * AGE+\beta_3 * 1(one child) * AGE+\beta_4 * 1(2+ children)*AGE$


# Exploratory Visualization

```{r}
library(ipumsr)
library(Stat2Data)
library(ggplot2)
library(dplyr)
library(moderndive) 
```

```{r}
# NOTE: To load data, you must download both the extract's data and the DDI
# and also set the working directory to the folder with these files (or change the path below).

if (!require("ipumsr")) stop("Reading IPUMS data into R requires the ipumsr package. It can be installed using the following command: install.packages('ipumsr')")

ddi <- read_ipums_ddi("highered_00002.xml")
data <- read_ipums_micro(ddi)
```

```{r}
data <- data[,!names(data) %in% c("WEIGHT", "SAMPLE", "SURID")]
```

```{r}
data_6years <- data %>%
  mutate(last06 = case_when(MR03Y5 >= 2006 | ACFPT == 1 | ACFPT == 2 ~ 1, 
                            MR03Y5 < 2006 | ACFPT == 98 | ACFPT == 3 ~ 0)) %>%
  mutate(chU6 = case_when(CH6IN == 0 | CH6IN == 98 ~ 0,
                          CH6IN == 1 ~ 1)) %>%
  mutate(GENDER = GENDER -1)
```
```{r}
data_6years$CHTOT <- factor(data_6years$CHTOT,
                       levels = c(98, 1,3),
                       labels = c("No Child", "One Child", "2 or More Children")
                       )
```

```{r}
model_6years <- glm( last06 ~ AGE + CHTOT, data = data_6years, family = binomial)
summary(model_6years)
```
```{r}
probabilities <- model_6years %>% 
  predict(data_6years, type = "response")
predicted.classes <- ifelse(probabilities> 0.5, 0, 1)
mean(predicted.classes == data_6years$last06)
```
```{r}
new_data1 <- exp(cbind(OR = coef(model_6years), confint(model_6years)))
head(new_data1)

```

```{r}
data_6years %>%
  ggplot(aes(x=AGE, y=last06, color= CHTOT)) +
  geom_point(
    position=position_jitter(height=.01)
    ) +
  geom_smooth(
    method=glm,
    method.args=list(family=binomial),
    se=FALSE,
    formula = y~x
    )
```

